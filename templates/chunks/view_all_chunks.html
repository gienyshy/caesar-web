{% extends "base.html" %}


{% block css %}
{{ block.super }}

<link rel="stylesheet" href="{{ STATIC_URL }}css/chunks.css" type="text/css" />
<link rel="stylesheet" href="{{ STATIC_URL }}css/comments.css" type="text/css" />
<link rel="stylesheet" href="{{ STATIC_URL }}css/syntax.css" type="text/css" />

{% if full_view %}
    <link rel="stylesheet" href="{{ STATIC_URL }}css/fullchunks.css" type="text/css" />
{% endif %}

{% endblock %}


{% block js %}

{{ block.super }}
{% include "chunks/chunk.html" %}

<script type="text/javascript" charset="utf-8">

$(document).ready(function() {
    var fileSystemText = {
        visible: 'Hide Files', 
        hidden: 'Show Files' 
    };
    var fileState = 'visible';

    if (fileState === 'visible') {
        $('#filesystem-text').show();
    } else {
        $('#filesystem-text').hide();
    }
    $('#file-action')
            .text(fileSystemText[fileState]);

    $('#file-action').click(function() {
        if (fileState === 'visible') {
            $('#filesystem-text').hide();
            fileState = 'hidden';
        } else {
            $('#filesystem-text').show();
            fileState = 'visible';
        }
        $(this).text(fileSystemText[fileState]);
    });

});
</script>
{% endblock %}




{% block breadcrumbs %}
  <a class="breadcrumb first-breadcrumb" href="{% url review.views.dashboard %}">Dashboard</a>
{% endblock %}

{% block secondary-toolbar %}
{% if read_only or comment_view %}
<div id="secondary-toolbar-inner">
    <button id="toggle-comments-button" type="button">
      Collapse all comments
    </button>
</div>
{% endif %}
{% endblock %}

{% block content %}
<div id="filesystem-text">
    {% for path, user_comments, static_comments in path_and_stats%}
        <div id="file-name-title">
            {% if read_only or comment_view %}
            <span class="comment-count" title="User Comments">
                {{ user_comments }},
            </span>
            <span class="robot-count" title="Automatic Comments">
                {{ static_comments }}
            </span>
            {% endif %}
            <A HREF="#{{path}}">{{ path }} </A>
        </div>
    {% empty %}
      No files found.
    {% endfor %}
</div>
<div id="file-action">Show Files</div>



{% for path, highlighted_lines_for_file in file_data %}
<h2 class="file-name-display">
<A NAME="{{path}}"></A> {{ path }}
</h2>

<table>
<tr>   
{% if read_only or comment_view %}
<td id="code-table-display">
<div id="comment-display" class="span-6">
    <div id="comment-display-inner">
        {% for highlighted_lines, is_chunk, chunk, comments in highlighted_lines_for_file %}
            {% if is_chunk %}
                {% for comment in comments %}
                    {% include "review/comment.html" %} 
                {% empty %}
                {% endfor %}
            {% endif %}
        {% empty %}
        {% endfor %}
    </div>
</div>
</td>
{% endif %}
<td id="code-table-display">
{% for highlighted_lines, is_chunk, chunk, comments in highlighted_lines_for_file %}
    {% if is_chunk %}
        <div id="chunk-display" class="span-18 last">
            <div id="chunk-{{chunk.id}}-dispaly" class="syntax">
            {% for n, line in highlighted_lines %}
            <span id="chunk-{{chunk.id}}-line-{{ n }}" class="chunk-line">
              <span id="line-{{chunk.id}}-{{ n }}" class="line">
                <span class="line-number">{{ n }}</span><pre class="line-code">{{ line|safe }}</pre>
              </span>
            </span>
            {% endfor %}
            </div>
        </div>
    {% else %}
        <div id="nonchunk-display" class="span-18 last">
            <div class="syntax">
            {% for n, line in highlighted_lines %}
            <span id="chunk-line-{{ n }}" class="nonchunk-line">
              <span id="line-{{ n }}" class="line">
                <span class="line-number">{{ n }}</span><pre class="line-code">{{ line|safe }}</pre>
              </span>
            </span>
            {% endfor %}
            </div>
        </div>
    {% endif %}
    {% empty %}
    {% endfor %}
</td></tr>
</table>
{% empty %}
{% endfor %}

{% endblock %}

