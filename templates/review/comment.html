{% load extra_tags %}

<!-- comment node ids are named like comment-$ID-$START-$END -->
<div id="comment-{{ comment.id }}-{{ comment.start }}-{{ comment.end }}" 
  class="comment 
         {% if comment.is_reply %}
           comment-reply 
           parent-{{ comment.parent_id }}
         {% endif %}
         {% if comment.type != 'U' %}comment-auto{% endif %}
         expanded">

  {% if not comment.is_reply %}
  <div class="comment-header">
    <span class="comment-line-numbers">
    {{ comment.start }}
    {% if comment.end != comment.start %} - {{ comment.end }}
    {% endif %}
    </span>
    <span class="comment-visibility">
    </span>
    <span class="comment-snippet">
    {{ snippet }}
    </span>
  </div>
  {% endif %}

  <div class="comment-author">
    {% if comment.type == 'U' %}
    {{comment.created|timesince_human}} ago 
    {% else %}
    automatically generated 
    {% endif %}
    by {{ comment.author.get_full_name|default:comment.author.username }}
  </div>
  
  <p class="comment-text">
    {{ comment.text }}
  </p>

  <div class="comment-footer">
    <span class="comment-votes">
      {% include "review/comment_votes.html" %}
    </span>
    {% if user.is_authenticated %}
    <span class="comment-actions">
      <span class="vote-buttons">
        <div id="upvote-{{ comment.id }}"  title="Upvote"
          class="vote up {% if vote == 1 %} selected {% endif %}"></div>
        <div id="downvote-{{ comment.id }}" title="Downvote"
          class="vote down {% if vote == -1 %} selected {% endif %}"></div>
      </span>
      <button id="reply-{{ comment.id }}-button" class="reply-button"
        type="button">Reply</button>
      {% if comment.author == user %}
      <button id="delete-{{ comment.id }}-button" class="delete-button" 
        type="button">Delete</button>
      {% endif %}
    </span>
  </div>
  {% endif %}
</div>
