{% load extra_tags %}
<script type="text/javascript">

$(document).ready(function() {

  // Remove all similar-comment divs whenever the user closes a new comment entry box.
  $(".new-comment").on("remove", function() {
    $(".similar-comment").remove();
    $("#similar-comments-wrapper").remove();
  });

  $("#textentry").keypress(function(event) {
    // Keys
    // 13  carriage return
    // 32  space
    var keys = [13, 32];
    if (keys.indexOf(event.which) != -1) {
      commentSearch.search($("#textentry").val(), "new-comment", "similar-comment");
    }

  });
});

</script>

<div class="comment new-comment" title="Add a comment">
  <div class="comment-header">
    <span class="comment-line-numbers">
    {{ start }}
    {% if end != start %} - {{ end }}
    {% endif %}
    </span>
    <span class="comment-snippet">
    {{ snippet }}
    </span>
  </div>
  <div class="comment-form">
    <form id="new-comment-form" 
      action="{% url 'review.views.new_comment' %}" method="post">
      {% csrf_token %}
      {{ form.text }}
      {{ form.start }}
      {{ form.end }}
      {{ form.chunk }}
      <button type="submit">Save</button>
      <button id="cancel-button" type="button">Cancel</button>
    </form>
  </div>
</div>
<div id='similar-comments-wrapper'></div>